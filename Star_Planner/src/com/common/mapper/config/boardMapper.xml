<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="board">
	
	<!-- insert -->
	<insert id="insert" parameterType="board">
		<selectKey keyProperty="board_no" resultType="_int" order="BEFORE">
			SELECT board_no_seq.nextval 
			FROM dual
		</selectKey>
		INSERT INTO board 
		VALUES (#{board_no},#{board_title},#{board_date},#{m_id},0,#{board_content},0,#{singer_id},#{board_writer_type})
	</insert>

	<!-- update -->
	<update id="update" parameterType="board">
		UPDATE board 
		SET board_title = #{board_title}, board_content = #{board_content} 
		WHERE board_no = #{board_no}
	</update>
	<update id="updateViewCount" parameterType="board">
		UPDATE board 
		SET board_hits = board_hits + 1 
		WHERE board_no = #{board_no}
	</update>
	
	<!-- delete -->
	<delete id="deleteByNo" parameterType="_int">
		delete from board where board_no = #{board_no}
	</delete>

	<!-- select -->
	<select id="selectByNo" parameterType="_int" resultType="board">
		SELECT board_no, board_title, board_date, m_id, board_hits, board_content, board_likes, singer_id, board_writer_type 
		FROM board 
		WHERE board_no = #{board_no}
	</select>
	<select id="selectList" parameterType="map" resultType="board">
		SELECT board_no, board_title, board_date, m_id, board_hits, board_content, board_likes, singer_id, board_writer_type 
		FROM(SELECT ceil(rownum/5) page, board_no, board_title, board_date, m_id, board_hits, board_content, board_likes, singer_id, board_writer_type 
		FROM(SELECT board_no, board_title, board_date, m_id, board_hits, board_content, board_likes, singer_id, board_writer_type 
		FROM board WHERE singer_id = #{singer_id} ORDER BY board_no DESC)) 
		WHERE page = #{page}
	</select>
	<select id="selectCountContents" resultType="_int">
		SELECT count(board_no) FROM board WHERE singer_id = #{singer_id}
	</select>
	<select id="selectBoardListByMemberId" parameterType="map" resultType="board">
		SELECT board_no, board_title, board_date, m_id, board_hits, board_content, board_likes, singer_id, board_writer_type 
		FROM(SELECT ceil(rownum/5) page, board_no, board_title, board_date, m_id, board_hits, board_content, board_likes, singer_id, board_writer_type 
		FROM(SELECT board_no, board_title, board_date, m_id, board_hits, board_content, board_likes, singer_id, board_writer_type 
		FROM board WHERE m_id = #{m_id} ORDER BY board_no DESC)) 
		WHERE page = #{page}
	</select>
</mapper>



