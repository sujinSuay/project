<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="comment">

<resultMap type="com.board.vo.Comment" id="comment-result">
	<id column="board_no" property="board_no"/>
	<id column="comment_id" property="comment_id"/>
	<id column="comment_content" property="comment_content"/>
	<id column="m_id" property="m_id"/>
	<id column="comment_date" property="comment_date"/>
</resultMap>



<insert id="insertComment" parameterType="com.board.vo.Comment" >
	<selectKey keyProperty="comment_id" resultType="int">
		select comment_id_seq.nextval as comment_id from dual
	</selectKey>
INSERT INTO comments
VALUES (#{board_no},comment_id , #{comment_content}, #{m_id}, #{comment_date})
</insert>

<select id="selectCommentId" resultType="_int">
select comment_id_seq.nextval from dual
</select>

<insert id="insertComment" parameterType="com.board.vo.Comment" >
INSERT INTO comments
VALUES (#{board_no},#{comment_id} , #{comment_content}, #{m_id}, #{comment_date})
</insert>

<select id="selectComment" resultMap="comment-result" parameterType="_int">
SELECT 
board_no, comment_id, comment_content, m_id, comment_date
FROM comments
WHERE board_no=#{board_no}

</select>

<delete id="deleteComment" parameterType="_int">
delete from comments where comment_id=#{comment_id}
</delete>

<update id="modifyComment" parameterType="hashmap">
UPDATE comments
SET comment_content = #{comment_content}
WHERE comment_id = #{comment_id}
</update>

<!-- memeber mypage에 코멘트 리스트 불러오는 쿼리 -->
<select id="selectCommentListByMemberId" parameterType="map" resultType="myPage">
	SELECT c.board_no, c.comment_id, c.comment_content, c.m_id, c.comment_date, s.singer_name, b.board_title
	FROM comments c, board b, singer s
	WHERE c.m_id = #{m_id} and b.board_no = c.board_no and s.singer_id = b.singer_id
	ORDER BY comment_date DESC
</select>

</mapper>
